mod api_interaction;
use reqwest::Error;

fn get_fileextension(s: &str) -> Option<&str> {
    let mut i = 0;
    for c in s.chars().rev() {
        if c == '.' {
            return Some(&s[(s.len() - i)..]); 
        }
        i+=1;
    }
    return None;
}

#[tokio::main]
async fn main() -> Result<(), Error>{    
    let api = api_interaction::GithubApiClient::new();
    //api.post_issue("First issue".to_string(), "Generated by action if successfull".to_string()).await?;
    let filemap = api.get_files().await?;

    for (k ,v) in &filemap{
        let extension = match get_fileextension(k) {
            Some(val) => val,
            None => continue
        };

        println!("Total lines: {}", v.len());
        for line in v {
            //let comment = match line.find("//") {
            //    Some(val) => &line[val..],
            //    None => continue
            //};
            
            println!("{}", line); 

        }
    }

    Ok(())
}
